<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Document</title>
  <!-- <link rel="stylesheet" href="http://at.alicdn.com/t/font_1144736_i494bongklp.css"> -->
  <link rel="stylesheet" href="CSS/goodsInfo.css">
 </head>
 <body>
	 <div class="home">
		<header id="head">
		</header>
		<div id="main">
			<div class="main_1" >
				<img src="" alt="" id="mlimg">
				<div class="main_2">
					<ul id="smimg"></ul>
				</div>
				<div class="share">
					<ul>
						<li>
							<a href="#" class="ashare1">分享</a>
						</li>
						<li>
							<a href="#" class="ashare2">收藏商品（100719）</a>
						</li>
						<li>
							<a href="#" class="ashare3">举报</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="main_3">
				<h1 class="title" id="title"></h1>
				<p class="title_1" id="title_1"></p>
				<div class="inset">
					<span class="price_1">价格</span>
					<span class="price" id="price"></span>
				</div>
				<div class="inset_1">
						<span class="freight">运费</span>
					<span class="city">杭州 ∨</span>
				</div>
				<div class="inset_2">
					<span class="sp1">累计评价</span>
					<span class="sp2" id="sp2">20782</span>
					<span class="sp3">送天猫积分</span>
					<span class="sp4">79</span>
				</div>
				<div class="inset_3">
					<span class="spa">颜色分类</span>
					<img src="images/gmessage/inset.jpg" class="img1" id="img1">
					<img src="images/gmessage/inset1.jpg" class="img2" id="img2">
				</div>
							<div class="inset_4">
					<span>数量</span>
					<span>
						<input type="text" value="1" class="text1" id="text1" title="请输入购买数量">
					</span>
					<span class="sa">
						<s class="s1" onclick="getAdd()">+</s>
						<s class="s2" onclick="getMinus()">-</s>
					</span>
					<span class="s3">件</span>
				</div>
				<div class="inset_5" id="inset_5">
				</div>
				<div class="inset_6">
					<ul>
						<li class="main_li1">服务承诺</li>
						<li>
							<a href="#" class="main_li2">正品保证</a>
						</li>
						<li>
							<a href="#" class="main_li3">极速退款</a>
						</li>
						<li>
							<a href="#" class="main_li4">赠运费险</a>
						</li>
						<li>
							<a href="#" class="main_li5">破损保障</a>
						</li>
						<li>
							<a href="#" class="main_li6">支付方式 v</a>
						</li>
						<li>
							<a href="#" class="main_li7">七天无理由退款</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="right">
				<div class="inner">
					<s></s>
					<span>看了又看</span>
				</div>
				<div class="right_1">
					<ul>
						<li>
							<a href="#"><img src="images/gmessage/01right.jpg" alt=""></a>
							<p>￥149.00</p>
						</li>
						<li>
							<a href="#"><img src="images/gmessage/02right.jpg" alt=""></a>
							<p>￥12.00</p>
						</li>
						<li>
							<a href="#"><img src="images/gmessage/03right.jpg" alt=""></a>
							<p>￥149.00</p>
						</li>
					</ul>
					<div class="icon">
						<a href="#" class="icon1"><i class="iconfont icon-shangjiantou"></i></a>
						<a href="#" class="icon2"><i class="iconfont icon-xiajiantou"></i></a>
					</div>
				</div>
			</div>
		</div>
		<div class="shop">
			<div class="name">
				<div class="qjd">
					<h3>
						<a href="#">thebeast野兽派官方旗舰店</a>
					</h3>
				</div>
				<div class="icon_1">
					<i class="iconfont icon-wangwang"></i>
				</div>
			</div>
			<div class="shop_1">
				<div calss="years"><span class="year">5</span>天猫5年店</div>
			</div>
			<div class="info">
				<a href="#">描述</a>
				<a href="#">服务</a>
				<a href="#">物流</a>
			</div>
			<div class="score">
				<a href="#">4.9
					<i class="iconfont icon-shangjiantou1"></i>
				</a>
				<a href="#">4.9
					<i class="iconfont icon-shangjiantou1"></i>
				</a>
				<a href="#">4.9
					<i class="iconfont icon-shangjiantou1"></i>
				</a>
			</div>
			<div class="text">
				<a href="#" class="jd">进店逛逛</a>
				<a href="#" class="sc">收藏店铺</a>
			</div>
		</div>
		<div class="container">
			<div class="spe">
				<h3>宝贝分类</h3>
			</div>
			<div class="content">
				<ul>
					<li>
						<a href="#">查看所有宝贝</a>
					</li>
					<li>
						<a href="#">易烊千玺同款</a>
					</li>
					<li>
						<a href="#">热销推荐</a>
					</li>
					<li>
						<a href="#">野兽经典</a>
					</li>
					<li>
						<a href="#">新品合集</a>
					</li>
					<li>
						<a href="#">限量合作系列</a>
					</li>
					<li>
						<a href="#">花艺/礼物</a>
					</li>
					<li>
						<a href="#">家饰</a>
					</li>
					<li>
						<a href="#">香氛/护理</a>
					</li>
					<li>
						<a href="#">餐桌</a>
					</li>
					<li>
						<a href="#">家居服/内衣</a>
					</li>
					<li>
						<a href="#">珠宝配饰</a>
					</li>
					<li>
						<a href="#">人群</a>
					</li>
					<li>
						<a href="#">价格</a>
					</li>
					<li>
						<a href="#">限时专享</a>
					</li>
				</ul>
			</div>
		</div>
		<div class="detail">
			<div class="product">
				<div class="d1">
					<a href="#">商品详情</a>
				</div>
				<div class="d2">
					<span class="sp1">累计评价</span>
					<span class="sp2">20851</span>
				</div>
			</div>
			<div class="brand">品牌名称：
				<b class="brand1">THEBEAST/野兽派</b>
			</div>
			<p class="path">产品参数：</p>
				<ul class="brand3">
					<li>品牌: THEBEAST/野兽派</li>
					<li>材质: 36%以上骨粉骨瓷</li>
					<li>容量: 101mL(含)-200mL(含)</li>
					<li>风格: 欧式</li>
					<li>产地: 中国大陆</li>
					<li>流行元素: 小清新</li>
					<li>颜色分类: 粉色新骨瓷马克杯 绿色新骨瓷马...</li>
					<li>马克杯价格区间: 80元以上</li>
					<li>货号: 骨瓷马克杯</li>
					<li>适用对象: 成人</li>
					<li>适用人群: 大众</li>
				</ul>
		</div>
		<div class="imgs">
			<ul>
				<li><img src="images/gmessage/01bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/02bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/03bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/04bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/05bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/06bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/07bottom.jpg" alt=""></li>
				<li><img src="images/gmessage/08bottom.jpg" alt=""></li>
			</ul>
		</div>
    <footer class="floor">
		</footer>
		<script src="JS/jquery-3.4.1.min.js"></script>
		<script src="JS/main.js"></script>
		<script>
		// 数据是其他格式的，需要转换成对象
		var lid=location.search.split('=')[1];
		//  页面加载就执行此函数
		 window.onload=function(){
			//  创建异步对象
			var xhr=new XMLHttpRequest();
			// 绑定监听，监听请求是否发送
      xhr.onreadystatechange=()=>{
				// 判断当前异步请求的状态
        if(xhr.readyState==4 && xhr.status==200){
					// 接收服务器传过来的数据并将格式转成json对象
					var res=JSON.parse(xhr.responseText);
					// console.log(res);
					// 把数据一一放入对应的标签中
					mlimg.src=res[0].details;
					title.innerHTML=res[0].title;
					title_1.innerHTML=res[0].subtitle;
					price.innerHTML=`￥${res[0].price}`;
					sp2.innerHTML=res[0].sold_count;
					for(var i=0;i<res.length;i++){
						smimg.innerHTML+=`
							<li>
								<img src="${res[i].sm}">
							</li>
						`
					}
					inset_5.innerHTML=`<a href="buy.html?lid=${res[0].lid}" class="buy">立即购买</a>
					<a href="#" class="car" onclick="insertCar();">加入购物车</a>`;
        }
			}
			// 打开连接，请求方法为get和路由方法的请求方式要保持一致，通过id获取对应的数据，所以需要将id传给服务器
			xhr.open("get",`/goodsinfo/detail?lid=${lid}`,true);
			// 发送请求
      xhr.send();
		}
		{
			// console.log(text1.value);
			function insertCar(){
				// 1.先
				// 2.加入购物车  数量的id 数量存储到sessionStorage
				// console.log(sessionStorage["id"]);
				if(sessionStorage["id"]){
					fetch(`/goodsinfo/getshop?id=${sessionStorage["id"]}&lid=${lid}`).then(res=>res.json()).then(data=>{
						console.log(data);
						var count=text1.value;
						if(data.length>0){
							fetch(`/goodsinfo/upshop?lid=${lid}&count=${count}`).then(res=>res.json()).then(data=>{

							})
						}else{
							fetch(`/goodsinfo/inshop?id=${sessionStorage["id"]}&lid=${lid}&count=${count}`).then(res=>res.json()).then(data=>{

							})
						}
					})
				}else{
					alert("还没有登录哦~请先前往登录页面进行登录");
				}
				// console.log(lid);
			}
			const tex=document.getElementsByClassName("text1")[0];
			function getAdd(){
				tex.value++;
			}
			function getMinus(){
				tex.value==1?tex.value=1:tex.value--;
			}
		}
		
		</script>
	</div>
 </body>
</html>