<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/shopping_car.css">
    <link rel="stylesheet" href="CSS/main.css">
    <title>Document</title>
</head>
<body>
  <div class="home">
    <header id="head">
    </header>
    <div class="shoppingbox">
        <h3 class="">
            <span class="c1">我的购物车 1</span>
            <span class="c2" style="font-size: 12px">配送至</span>
            <select name="" id="s1">
                <option value="" class="o1">上海/黄浦区</option>
            </select>
        </h3>
        <div class="head1">
            <input id="i1" type="checkbox">
            <div class="col6">全选</div>
            <div class="col1">商品信息</div>
            <div class="col2">单价（元）</div>
            <div class="col3">数量</div>
            <div class="col4">金额（元）</div>
            <div class="col5">操作</div>
        </div>
        <div class="d2">
            <input type="checkbox" id='i2'>
            <a href="#">幽美瑞品手表专营店</a>
        </div>
        <div class="d3" id="d3">
            
        </div>
        <script>
            function sub(){
                if(num.value>1)
                num.value--;
                if(num.value<1)
                num.value=1;
                d1.innerHTML='￥'+price.innerHTML*num.value+'.00';
                d5d22.innerHTML=d1.innerHTML;
                d7.innerHTML=num.value;
                d522.innerHTML="商品应付总计："+d5d22.innerHTML;
                d466.innerHTML="商品应付总计："+d5d22.innerHTML;
            }
            function add(){
                if(num.value>9)
                num.value=9;
                if(num.value<9)
                num.value++;
                d1.innerHTML='￥'+price.innerHTML*num.value+'.00';
                d5d22.innerHTML=d1.innerHTML;
                d7.innerHTML=num.value;
                d522.innerHTML="商品应付总计："+d5d22.innerHTML;
                d466.innerHTML="商品应付总计："+d5d22.innerHTML;
            }
        </script>
        <div class="d4">
            <span class="d4s1">活动优惠：-￥0.00</span>
            <span class="d4s2" id="d466"></span>
            <span class="d4s3">预估税费：￥0.00</span>
        </div>
        <div class="d5">
            <div class="d5d1">
                <input type="checkbox" id="i4">
                <span style="font-size: 13px;">全选</span>
                <a href="#">删除选中商品</a>
            </div>
            <div class="d5d2">
                <span class="d5d2p1">已选商品 <em class="d5d2e1" id="d7"> 1 </em> 件</spam>
                <span class="d5d2p2">总价（不含运费）：<em class="d5d2e2" onclick="getFun();" id="d5d22"></em></span>
            </div>
            <div class="d5d3">
                <span class="d5s1">活动优惠：-￥0.00</span>
                <span class="d5s2" id="d522"></span>
                <span class="d5s3">商品税费（不含运费税）：￥0.00</span>
            </div>
                <a href="#" class="d5a1">去结算</a>
        </div>
        <script>
            function info1(){
                i1.onclick=function(){
                if(i1.checked==true){
                    i2.checked=true;
                    i3.checked=true;
                    i4.checked=true;
                }else{
                    i2.checked=false;
                    i3.checked=false;
                    i4.checked=false;
                }
                }
            }
            info1();
            function info2(){
                i4.onclick=function(){
                    if(i4.checked==true){
                    i1.checked=true;
                    i2.checked=true;
                    i3.checked=true;
                }else{
                    i1.checked=false;
                    i2.checked=false;
                    i3.checked=false;
                }
                }
            }
            info2();
        </script>
    </div>
    <footer class="floor">
    </footer>
  </div>
  <script src="JS/jquery-3.4.1.min.js"></script>
  <script src="JS/main.js"></script>
  <script>
	  //  页面加载就执行此函数
      window.onload=function(){
			//  创建异步对象
          var xhr=new XMLHttpRequest();
			// 绑定监听，监听请求是否发送
          xhr.onreadystatechange=function(){
				// 判断当前异步请求的状态
              if(xhr.readyState==4 && xhr.status==200){
					// 接收服务器传过来的数据并将格式转成json对象
                  var res=JSON.parse(xhr.responseText);
                  console.log(res);
					// 把数据一一放入对应的标签中
                  d3.innerHTML=`
                  <ul class="d3u1">
                        <li class="d3l1">
                            <div class="d3d1">
                                <input type="checkbox" id="i3">
                            </div>
                            <div class="d3d2">
                                <a href="#" class="d3a1">
                                    <img src="${res[0].sm}" alt="">
                                </a>
                            </div>
                            <div class="d3d3">
                                <a href="#" class="d3a2">${res[0].title}</a> 
                                <p class="d3p1"><img src="images/shopcar/shoppingcar2.png" alt="">支持7天无忧退货
                                </p>
                                <p>
                                    <span class="d3p2">
                                        特价 <a class="d3p3">^</a>
                                    </span>
                                </p>
                            </div>
                            <div class="d3d4">颜色：黑色</div>
                            <div class="d3d5">
                                <p class="d3d5p1">${res[0].p_price}</p>
                                <p class="d3d5p2" id="price">${res[0].price}</p>
                            </div>
                            <div class="d3d6">
                                <button class="d3d6b1" onclick='sub()'>-</button>
                                <input type="text" class="d3d6i1" id='num' value='1'>
                                <button class="d3d6b2" onclick='add()'>+</button>
                                <p class="d3d6p1">仅剩9件</p>
                            </div>
                            <div class="d3d7" id="d1">${res[0].price}</div>
                            <div class="d3d8">
                                <a href="#">删除</a>
                                <br>
                                <a href="#">移入我的收藏</a>
                            </div>
                        </li>
                    </ul>
                  `;
                  d466.innerHTML=`商品应付总计：￥${res[0].price}`;
                  d5d22.innerHTML=`￥${res[0].price}`;
                  d522.innerHTML=`商品应付总计：￥${res[0].price}`;
              }
          }
			// 数据是其他格式的，需要转换成对象
          var lid=location.search.split('=')[1];
			// 打开连接，请求方法为get和路由方法的请求方式要保持一致，通过id获取对应的数据，所以需要将id传给服务器
          xhr.open("get","/shopping_car/shop?lid="+lid,true);
			// 发送请求
          xhr.send();
      }
  </script>
</body>
</html>